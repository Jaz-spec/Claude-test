ports:
  - name: Dev Server
    description: Development server
    port: 3000
    onOpen: open-browser
    visibility: public

tasks:
  - name: Setup
    init: |
      npm install
      npm install -g @openai/codex
      gp sync-done install-complete
    command: |
      echo "Checking codex config..."
      codex config list || echo "No config found"
      echo "Environment: $OPENAI_API_KEY"
      npm run dev
  
  - name: Codex
    command: |
      gp sync-await install-complete
      codex

# tasks:
#   - name: Setup
#     init: |
#       npm install
#       npm install -g @openai/codex
#       gp sync-done install-complete
#     command: |
#       npm run dev
  
#   - name: Codex
#     command: |
#       gp sync-await install-complete
#       codex

# tasks:
#   - name: Setup
#     init: |
#       npm install
#       npm install -g @openai/codex
#     command: |
#       # Configure codex with the API key from Gitpod secrets
#       codex config set api-key $OPENAI_API_KEY
#       gp sync-done install-complete
  
#   - name: Codex
#     command: |
#       gp sync-await install-complete
#       codex
#     openMode: tab-after
      
#   - name: Server
#     command: |
#       gp sync-await install-complete
#       npm run dev